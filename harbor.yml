# Configuration file of Harbor

# The IP address or hostname to access admin UI and registry service.
hostname: harbor.local  # Changed to a more specific hostname (you can replace this with your preferred domain)

# http related config
http:
  # port for http, default is 80. If https enabled, this port will redirect to https port
  port: 80

# https related config
https:
  # https port for harbor, default is 443
  port: 443
  # The path of cert and key files for nginx
  certificate: /certs/harbor.crt
  private_key: /certs/harbor.key

# The initial password of Harbor admin
# It only works in first time to install harbor
# Remember Change the admin password from UI after launching Harbor.
harbor_admin_password: Harbor12345  # Consider changing to something more secure

# Harbor DB configuration
database:
  # Using ODBC connection
  type: odbc
  dsn: HARBOR_DB
  username: postgres
  password: root123  # Consider changing to something more secure
  # The maximum number of connections in the idle connection pool. If it <=0, no idle connections are retained.
  max_idle_conns: 100
  # The maximum number of open connections to the database. If it <= 0, then there is no limit on the number of open connections.
  max_open_conns: 900
  conn_max_lifetime: 5m
  conn_max_idle_time: 0

# Docker configuration
docker:
  insecure_registry: true
  buildkit_builder: default
  buildx_install_url: ""  # Will use system installed buildx
  compose_version: v2

# The default data volume
data_volume: /data

# Log configurations
log:
  # options are debug, info, warning, error, fatal
  level: info
  # configs for logs in local storage
  local:
    rotate_count: 50
    rotate_size: 200M
    location: /var/log/harbor

# Trivy configuration
trivy:
  ignore_unfixed: false
  skip_update: false
  skip_java_db_update: false
  offline_scan: false
  security_check: vuln
  insecure: false
  timeout: 5m0s

jobservice:
  # Maximum number of job workers in job service
  max_job_workers: 10
  job_loggers:
    - STD_OUTPUT
    - FILE
  logger_sweeper_duration: 1 #days

notification:
  webhook_job_max_retry: 3
  webhook_job_http_client_timeout: 3 #seconds

# Enable purge _upload directories
upload_purging:
  enabled: true
  age: 168h
  interval: 24h
  dryrun: false

# Swarm configuration
swarm_mode:
  enabled: true
  worker_nodes: 1
  manager_nodes: 1

# Registry configuration
registry:
  relative_urls: true
  storage:
    filesystem:
      rootdirectory: /storage
    maintenance:
      uploadpurging:
        enabled: true
        age: 168h
        interval: 24h
        dryrun: false

# Configure external database
external_database:
  harbor:
    host: harbor-db
    port: 5432
    db_name: harbor
    username: postgres
    password: root123
    ssl_mode: disable
    max_idle_conns: 100
    max_open_conns: 900

# Integration with Harpoon
harpoon:
  enabled: true
  endpoint: http://harpoon-service:8080

# This attribute is for migrator to detect the version of the .cfg file, DO NOT MODIFY!
_version: 2.12.0